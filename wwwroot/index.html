<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>–í–∏–¥–µ–æ–ü–æ–∏—Å–∫</title>
    <base href="/" />
    <link href="css/bootstrap/bootstrap.min.css" rel="stylesheet" />
    <link href="css/app.css" rel="stylesheet" />
    <link href="manifest.json" rel="manifest" />
    <link rel="apple-touch-icon" sizes="512x512" href="icon-512.png" />
</head>


<body>
    <app>Loading...</app>

    <div id="blazor-error-ui">
        –û—à–∏–±–∫–∞.
        <a href="" class="reload">–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å.</a>
        <a class="dismiss">üóô</a>
    </div>

    <!--<script src="decode.js"></script>-->
    <script src="_framework/blazor.webassembly.js" autostart="false"></script>

    <!--<script src="_framework/blazor.webassembly.js"></script>-->

    <script>navigator.serviceWorker.register('service-worker.js');</script>


    <script src="https://apis.google.com/js/api.js"></script>

    <script>

        function authenticate() {
            return gapi.auth2.getAuthInstance()
                .signIn({ scope: "https://www.googleapis.com/auth/youtube.force-ssl" })
                .then(function () { console.log("Sign-in successful"); return "true"; },
                    function (err) { console.error("Error signing in", err); return "false"; });
        }

        var lastPl;

        function loadErrBig(st, ex) {
            return confirm(st + " –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å ?" + "\n" + "--->" + JSON.stringify(ex));
        }
        function loadErr(st, ex) {
            return "!!!" + confirm(st + " –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å ?").toString() + "--->" + JSON.stringify(ex.error.message);
        }

        function loadClient(f) {

            lastPl = 'G2CHyuF74R0';

            try {
                gapi.client.setApiKey(f);
                /*throw new Error('something went wrong');*/
                return gapi.client.load("https://www.googleapis.com/discovery/v1/apis/youtube/v3/rest")
                    .then(
                        function () {
                            console.log("GAPI client loaded for API");
                            return "";
                        },
                        function (err) {
                            //https://stackoverflow.com/questions/24563863/catch-error-from-gapi-client-load
                            //https://github.com/google/google-api-javascript-client/blob/master/docs/samples.md
                            console.error("Error loading GAPI client for API 1", err);
                            return loadErr("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ 1.", err);

                        });
            } catch (err) {
                console.error("Error loading GAPI client for API 0", err);
                return loadErr("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ 2.", err);

            }
        }

        //return gapi.client.language.translations.list({
        //    q: 'hello world',
        //    source: 'en',
        //    target: 'de',
        //});
        //}).then(function (response) {
        //    console.log(response.result.data.translations[0].translatedText);
        //}, function (reason) {
        //    console.log('Error: ' + reason.result.error.message);
        //});


        window.nextVideoS = function (more, mo) {
            return gapi.client.youtube.search.list({
                "part": [
                    "snippet"
                ],
                "maxResults": 50,
                "q": more,
                "type": [
                    "video"]
                ,
                "videoEmbeddable": true, "videoSyndicated": true,
                "pageToken": mo
            })
                .then(
                    function (response) {
                        return JSON.stringify(response);
                    }
                    ,
                    function (err) {
                        console.error("Error loading videoSearch", err);
                        return loadErr("–ü–æ–∏—Å–∫ next –≤—ã–¥–∞–ª –æ—à–∏–±–∫—É.", err);
                    });
        }

        function videoSearch(more) {
            return gapi.client.youtube.search.list({
                "part": [
                    "snippet"
                ],
                "maxResults": 50,
                "q": more,
                "type": [
                    "video"]
                ,
                "videoEmbeddable": true
                ,
                "videoSyndicated": true
            })
                .then(
                    function (response) {
                        return JSON.stringify(response);
                    }
                    ,
                    function (err) {
                        console.error("Error loading videoSearch", err);
                        return loadErr("–ü–æ–∏—Å–∫ –≤—ã–¥–∞–ª –æ—à–∏–±–∫—É.", err);
                    });
        }



        function videoDetails(more) {

            return gapi.client.youtube.videos.list({
                "part": [
                    "contentDetails"
                ],
                "id": more

            })
                .then(function (response) {

                    return JSON.stringify(response);
                },
                    function (err) {
                        console.error("Error loading videoDetails", err);

                        return loadErr("–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–∏—Å–∫–∞ –≤—ã–¥–∞–ª–∞ –æ—à–∏–±–∫—É.", err);
                    });
        }

        gapi.load('client',
            function () { console.log("GAPI load"); });


    </script>

    <!--<script>
        function UserException(message) {
            this.message = message;
            this.name = "–ò—Å–∫–ª—é—á–µ–Ω–∏–µ, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º";
        };
    </script>-->

    <script>

        function delCha(cha, opis) {
            n = 0;
            try {
                for (i = n; i < cha.length; i++) {
                    document.getElementById(opis + cha[i]).checked = false;
                }

                /*throw new UserException("–ù–µ–≤–µ—Ä–Ω–æ —É–∫–∞–∑–∞–Ω –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞1");*/

                return "";
            } catch (err) {

                /*throw new UserException("–ù–µ–≤–µ—Ä–Ω–æ —É–∫–∞–∑–∞–Ω –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞2");*/

                console.error("Error loading del" + opis + "Cha: " + n, err);
                return loadErr("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∏—Å–ø—Ä–∞–≤–Ω–∞ 2-a " + opis + " . –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É. " + n, err);
            }

        };

        function delSvdCha(cha) {
            n = 0;
            try {
                for (i = n; i < cha.length; i++) {
                    document.getElementById("svd" + cha[i]).checked = false;
                }
                return "";
            } catch (err) {
                console.error("Error loading delSvdCha: " + n, err);
                return loadErr("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∏—Å–ø—Ä–∞–≤–Ω–∞ 1. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É. " + n, err);
            }
        };

        function delPlyCha(cha) {
            n = 0;
            try {
                for (i = n; i < cha.length; i++) {
                    document.getElementById("play" + cha[i]).checked = false;
                }
                return "";
            } catch (err) {
                console.error("Error loading delPlyCha: " + n, err);
                return loadErr("–ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ –∏—Å–ø—Ä–∞–≤–Ω–∞ 2-b. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É. " + n, err);
            }

        };
    </script>

    <script>

        window.mkYouTubeIframeAPIReadyLast = function (pl) {
            try {
                lastPl = pl;

                var tag = document.createElement('script');

                tag.src = "https://www.youtube.com/iframe_api";
                var firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                console.log("mkYouTubeIframeAPIReadyLast");
                return "";
            }
            catch (err) {
                console.error("Error loading mkYouTubeIframeAPIReadyLast", err);
                return loadErr("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ 3.", err);

            };
        };


        function mkYouTubeIframeAPIReady() {
            try {
                var tag = document.createElement('script');

                tag.src = "https://www.youtube.com/iframe_api";
                var firstScriptTag = document.getElementsByTagName('script')[0];
                firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
                console.log("mkYouTubeIframeAPIReady");
                return "";
            }
            catch (err) {
                console.error("Error loading mkYouTubeIframeAPIReady", err);
                return loadErr("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ 4.", err);

            };
        };

        function stopVideo() {
            player.stopVideo();
        }

        var index = 0;
        var videos = [];

        window.playMany = function (yyy) {
            index = 0;
            videos = yyy;

            try {
                player.loadVideoById(videos[index], 0, "large");
                return "";
            }
            catch (err) {
                var vil;
                try { vil = videos[index]; } catch (err2) { vil = " ( --- ) "; }

                console.error("Error loading playMany", err);
                return loadErr("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ 5.", err);


            }
        }

        window.playOne = function (yyy) {

            try {
                player.loadVideoById(yyy, 0, "large");
                return "";
            }
            catch (err) {

                console.error("Error loading playOne", err);
                return loadErr("–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ 6.", err);


            }
        }



        var player;

        function onYouTubeIframeAPIReady() {
            try {
                console.log("mkYouTubeIframeAPIReady1");
                player = new YT.Player('player', {

                    videoId: lastPl,
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange
                    }
                });
                console.log("onYouTubeIframeAPIReady");


            }
            catch (err) {

                bigErr(err, "3 ", "onYouTubeIframeAPIReady");

            }
        }


        function onPlayerReady(event) {
            try {
                event.target.playVideo();

            }
            catch (err) {

                bigErr(err, "2 ", "onPlayerReady");

            }
        }



        function onPlayerStateChange(event) {
            try {
                if (event.data === YT.PlayerState.ENDED) {

                    if (index < videos.length - 1) {
                        index = index + 1;
                        event.target.loadVideoById(

                            videos[index], 0, "large");

                    };

                }
            }
            catch (err) {
                var vil;
                try { vil = videos[index]; } catch (err2) { vil = " ( --- ) "; }

                bigErr(err, "1 " + vil, "onPlayerStateChange");


            }
        }

        window.bigErr = function (er, number, name) {

            console.error("Error loading " + name, er);

            var eerStr = "";

            try { eerStr = JSON.stringify(er.error.message); } catch { }

            if (loadErrBig("–û–±—Ä—ã–≤ —Å–≤—è–∑–∏ " + number + ". ", er)) {
                DotNet.invokeMethodAsync('WebApplicationONE', 'ReloadApp');
            }
            else {
                DotNet.invokeMethodAsync('WebApplicationONE',
                    'NoReloadAppSetErrOpis', "–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–≤—è–∑–∏ " + number + ". " + "--->" + JSON.stringify(er) + "--->" + eerStr);
            };
        }

    </script>
    
    <script type="module">
        window.BrotliDecode = BrotliDecode;
        import { BrotliDecode } from './decode.min.js';
        Blazor.start({
            loadBootResource: function (type, name, defaultUri, integrity) {
                if (type !== 'dotnetjs' && location.hostname !== 'localhost') {
                    return (async function () {
                        const response = await fetch(defaultUri + '.br', { cache: 'no-cache' });
                        if (!response.ok) {
                            throw new Error(response.statusText);
                        }
                        const originalResponseBuffer = await response.arrayBuffer();
                        const originalResponseArray = new Int8Array(originalResponseBuffer);
                        const decompressedResponseArray = BrotliDecode(originalResponseArray);
                        const contentType = type ===
                            'dotnetwasm' ? 'application/wasm' : 'application/octet-stream';
                        return new Response(decompressedResponseArray,
                            { headers: { 'content-type': contentType } });
                    })();
                }
            }
        });
    </script>

</body>

</html>
